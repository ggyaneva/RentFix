<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="en">

<body>

<nav th:fragment="navbar" class="navbar fixed-navbar">
    <div class="navbar-container">

        <!-- Brand -->
        <a class="navbar-brand" th:href="@{/}">
            RentFix
        </a>

        <!-- Menu -->
        <ul class="navbar-nav" id="navbar-nav">

            <!-- TENANT ONLY: Browse -->
            <li sec:authorize="hasRole('TENANT')">
                <a th:href="@{/properties}"
                   class="nav-link"
                   th:classappend="${currentPath != null and currentPath.startsWith('/properties')} ? ' active'">
                    Browse Properties
                </a>
            </li>

            <!-- TENANT HISTORY -->
            <li sec:authorize="hasRole('TENANT')">
                <a th:href="@{/tenant/contract-history}"
                   class="nav-link"
                   th:classappend="${currentPath != null and currentPath.startsWith('/tenant/contract-history')} ? ' active'">
                    History
                </a>
            </li>


            <!-- TENANT -->
            <li sec:authorize="hasRole('TENANT')">
                <a th:href="@{/tenant/dashboard}"
                   class="nav-link"
                   th:classappend="${currentPath != null and currentPath.startsWith('/tenant/dashboard')} ? ' active'">
                    Tenant Dashboard
                </a>
            </li>

            <!-- OWNER -->
            <li sec:authorize="hasRole('OWNER')">
                <a th:href="@{/owner/dashboard}"
                   class="nav-link"
                   th:classappend="${currentPath != null and currentPath.startsWith('/owner')} ? ' active'">
                    Owner Dashboard
                </a>
            </li>

            <!-- ADMIN -->
            <li sec:authorize="hasRole('ADMIN')">
                <a th:href="@{/admin/dashboard}"
                   class="nav-link"
                   th:classappend="${currentPath != null and currentPath.startsWith('/admin')} ? ' active'">
                    Admin Dashboard
                </a>
            </li>

            <!-- PROFILE -->
            <li th:if="${#authentication.principal != null}">
                <a th:href="@{/profile}"
                   class="nav-link"
                   th:classappend="${currentPath != null and currentPath.startsWith('/profile')} ? ' active'">
                    My Profile
                </a>
            </li>

            <!-- GUEST: Login -->
            <li th:if="${#authentication.principal == null}">
                <a class="btn-nav" th:href="@{/auth/login}">Sign In</a>
            </li>

            <!-- LOGOUT -->
            <li th:if="${#authentication.principal != null}">
                <form th:action="@{/logout}" method="post">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                    <button type="submit" class="btn-nav btn-nav-outline">Sign Out</button>
                </form>
            </li>

        </ul>
    </div>
</nav>

</body>
</html>
