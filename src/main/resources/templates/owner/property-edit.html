<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <title>Edit Property - RentFix</title>
    <th:block th:replace="~{fragments/header :: head}"></th:block>
</head>

<body>

<div th:replace="~{fragments/navbar :: navbar}"></div>

<div class="page-content">
    <div class="container">

        <!-- HEADER -->
        <div class="page-header">
            <h1 th:text="'Edit: ' + ${property.title}"></h1>
            <p class="text-secondary">Modify property information</p>
        </div>

        <div class="form-card card">

            <!-- EDIT FORM -->
            <form th:action="@{/properties/owner/edit/{id}(id=${property.id})}"
                  th:object="${property}"
                  method="post"
                  enctype="multipart/form-data">

                <div class="form-grid">

                    <!-- TITLE -->
                    <div class="form-group">
                        <label class="form-label">Title</label>
                        <input class="form-control" th:field="*{title}" required>
                    </div>

                    <!-- CITY -->
                    <div class="form-group">
                        <label class="form-label">City</label>
                        <input class="form-control" th:field="*{city}" required>
                    </div>

                    <!-- ADDRESS -->
                    <div class="form-group form-full">
                        <label class="form-label">Address</label>
                        <input class="form-control" th:field="*{address}" required>
                    </div>

                    <!-- DESCRIPTION -->
                    <div class="form-group form-full">
                        <label class="form-label">Description</label>
                        <textarea class="form-control" th:field="*{description}" rows="3"></textarea>
                    </div>

                    <!-- BEDROOMS -->
                    <div class="form-group">
                        <label class="form-label">Bedrooms</label>
                        <input type="number" class="form-control" th:field="*{bedrooms}" required>
                    </div>

                    <!-- BATHROOMS -->
                    <div class="form-group">
                        <label class="form-label">Bathrooms</label>
                        <input type="number" class="form-control" th:field="*{bathrooms}" required>
                    </div>

                    <!-- AREA -->
                    <div class="form-group">
                        <label class="form-label">Area (sqm)</label>
                        <input type="number" step="0.1" class="form-control" th:field="*{areaSqm}">
                    </div>

                    <!-- MONTHLY RENT -->
                    <div class="form-group">
                        <label class="form-label">Monthly Rent (â‚¬)</label>
                        <input type="number" step="0.1" class="form-control"
                               th:field="*{monthlyRent}" required>
                    </div>

                </div>

                <!-- IMAGE UPLOAD -->
                <div class="form-group form-full mt-4">
                    <label class="form-label">Upload New Images</label>
                    <input type="file" name="images" class="form-control" multiple>
                </div>

                <!-- EXISTING IMAGES -->
                <div class="form-group form-full mt-4">
                    <label class="form-label">Current Images</label>

                    <div class="image-gallery-grid" th:if="${property.imageUrls != null}">
                        <div class="image-card" th:each="img : ${property.imageUrls}">
                            <img th:src="${img}" class="property-image-card-small">

                            <!-- DELETE BUTTON -->
                            <form th:action="@{/properties/owner/image/delete/{id}(id=${property.id})}"
                                  method="post" class="mt-2">
                                <input type="hidden" name="imageUrl" th:value="${img}"/>
                                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                                <button class="btn btn-danger w-100" type="submit">Delete</button>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- CSRF -->
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

                <!-- ACTIONS -->
                <div class="form-actions">
                    <button class="btn btn-primary" type="submit">Save Changes</button>
                    <a class="btn btn-outline-light" th:href="@{/owner/dashboard}">Cancel</a>
                </div>

            </form>
        </div>

    </div>
</div>

<th:block th:replace="~{fragments/footer :: footer}"></th:block>
</body>
</html>
